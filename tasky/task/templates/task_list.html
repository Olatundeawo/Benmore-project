{% extends 'base.html' %}

{% block content %}

<form action="{% url 'search_tasks' %}" method="get">
    <input name="q" type="text" placeholder="Search..." class="search">
  </form>

<div class="container mx-auto py-8">
    <div class="flex justify-between items-center mb-6">
        <h1 class="text-3xl font-bold"> Tasky Dashboard</h1>
        <button class="bg-blue-500 text-white px-4 py-2 rounded"><a href="{% url 'create_task' %}">+Add Task</a></button>
    </div>
    <div class="flex space-x-4 taskList">
        
        
        <div class="w-1/3">
            <h2 class="text-xl font-semibold mb-4"> In Progress <span>{{progress_count}}</span></h2>
            <div class="space-y-4" id="progress_tasks">
                
                {% for task in progress %}
                {% include 'fetch_task.html' with task=task %}
                
                {% endfor %}
            </div>
        </div>
        
        
        <div class="w-1/3">
            <h2 class="text-xl font-semibold mb-4"> Completed <span>{{completed_count}}</span></h2>
            <div class="space-y-4" id="completed_tasks">
                {% for task in completed %}
                {% include 'fetch_task.html' with task=task %}
                {% endfor %}
            </div>
        </div>
        
        
        <div class="w-1/3">
            <h2 class="text-xl font-semibold mb-4"> Overdue <span>{{ overdue_count}}</span></h2>
            <div class="space-y-4" id="overdue_tasks">
                {% for task in overdue %}
                {% include 'fetch_task.html' with task=task %}
                {% endfor %}
            </div>
        </div>
        
    </div>
</div>


<script>
    function fetchTasks(status) {
        $.ajax({
            url: `fetch_task/${status}`,
            success: function(data) {
                $(`#${status}_tasks`).html(data);
            }
        });
    }

    
    setInterval(function() {
        fetchTasks('progress');
        fetchTasks('completed');
        fetchTasks('overdue');
        
    }, 5000);
</script>

{% endblock %}